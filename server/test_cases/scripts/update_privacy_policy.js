require('dotenv').config({ path: '../../.env' });
const mongoose = require('mongoose');
const Page = require('../../models/Page');

const privacyContent = `
<div class="bg-gray-50 dark:bg-white/5 border border-gray-200 dark:border-white/10 rounded-2xl p-8 mb-12 shadow-sm dark:shadow-none transition-colors">
    <p class="text-gray-600 dark:text-gray-300 leading-relaxed">
        Welcome to Safe360. We respect your privacy and want to protect your personal information. This Privacy Policy serves to explain how we collect, use, disclose, and safeguard your information when you visit our website safe360.com and use our training platforms, including our VR/AR applications, mobile apps, and Learning Management System (LMS). Please read this privacy policy carefully. If you do not agree with the terms of this privacy policy, please do not access the site.
    </p>
    <p class="text-gray-600 dark:text-gray-300 leading-relaxed mt-4">
        Safe360 ("us", "we", or "our") operates the website and the Safe360 mobile application (the "Service"). This page informs you of our policies regarding the collection, use, and disclosure of personal data when you use our Service and the choices you have associated with that data.
    </p>
</div>

<div class="space-y-16">
    <!-- Section 1: Definitions -->
    <section>
        <div class="flex items-center space-x-3 mb-6">
            <!-- Icon: FileText -->
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-secondary"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><line x1="10" y1="9" x2="8" y2="9"></line></svg>
            <h2 class="text-3xl font-bold text-gray-900 dark:text-white m-0">1. Definitions</h2>
        </div>
        <div class="text-gray-600 dark:text-gray-400 space-y-4 pl-4 border-l-2 border-gray-200 dark:border-white/10">
            <p><strong>Service:</strong> Service is the safe360.com website and the Safe360 mobile application operated by Safe360.</p>
            <p><strong>Personal Data:</strong> Personal Data means data about a living individual who can be identified from those data (or from those and other information either in our possession or likely to come into our possession).</p>
            <p><strong>Usage Data:</strong> Usage Data is data collected automatically either generated by the use of the Service or from the Service infrastructure itself (for example, the duration of a page visit).</p>
            <p><strong>Cookies:</strong> Cookies are small pieces of data stored on your device (computer or mobile device).</p>
            <p><strong>Data Controller:</strong> Data Controller means the natural or legal person who (either alone or jointly or in common with other persons) determines the purposes for which and the manner in which any personal information are, or are to be, processed.</p>
            <p><strong>Data Processors (or Service Providers):</strong> Data Processor (or Service Provider) means any natural or legal person who processes the data on behalf of the Data Controller.</p>
            <p><strong>Data Subject (or User):</strong> Data Subject is any living individual who is using our Service and is the subject of Personal Data.</p>
        </div>
    </section>

    <!-- Section 2: Information Collection -->
    <section>
        <div class="flex items-center space-x-3 mb-6">
            <!-- Icon: Database -->
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-secondary"><ellipse cx="12" cy="5" rx="9" ry="3"></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path><path d="M3 5v14c0 1.66 4 3 9 3s 9-1.34 9-3V5"></path></svg>
            <h2 class="text-3xl font-bold text-gray-900 dark:text-white m-0">2. Information Collection and Use</h2>
        </div>
        <p class="text-gray-600 dark:text-gray-400 mb-6">
            We collect several different types of information for various purposes to provide and improve our Service to you.
        </p>
        
        <h3 class="text-xl font-bold text-gray-900 dark:text-white mt-8 mb-4">Types of Data Collected</h3>
        
        <div class="bg-gray-50 dark:bg-white/5 rounded-xl p-6 mb-6 border border-gray-200 dark:border-white/10 transition-colors">
            <h4 class="text-lg font-bold text-secondary mb-2">Personal Data</h4>
            <p class="text-gray-600 dark:text-gray-400 mb-4">
                While using our Service, we may ask you to provide us with certain personally identifiable information that can be used to contact or identify you ("Personal Data"). Personally identifiable information may include, but is not limited to:
            </p>
            <ul class="list-disc pl-6 text-gray-600 dark:text-gray-400 space-y-1">
                <li>Email address</li>
                <li>First name and last name</li>
                <li>Phone number</li>
                <li>Address, State, Province, ZIP/Postal code, City</li>
                <li>Cookies and Usage Data</li>
            </ul>
        </div>

        <div class="bg-gray-50 dark:bg-white/5 rounded-xl p-6 mb-6 border border-gray-200 dark:border-white/10 transition-colors">
            <h4 class="text-lg font-bold text-secondary mb-2">Usage Data</h4>
            <p class="text-gray-600 dark:text-gray-400 mb-4">
                We may also collect information that your browser sends whenever you visit our Service or when you access the Service by or through a mobile device ("Usage Data").
            </p>
            <p class="text-gray-600 dark:text-gray-400 mb-4">
                This Usage Data may include information such as your computer's Internet Protocol address (e.g. IP address), browser type, browser version, the pages of our Service that you visit, the time and date of your visit, the time spent on those pages, unique device identifiers and other diagnostic data.
            </p>
            <p class="text-gray-600 dark:text-gray-400">
                When you access the Service by or through a mobile device, this Usage Data may include information such as the type of mobile device you use, your mobile device unique ID, the IP address of your mobile device, your mobile operating system, the type of mobile Internet browser you use, unique device identifiers and other diagnostic data.
            </p>
        </div>

        <div class="bg-gray-50 dark:bg-white/5 rounded-xl p-6 border border-gray-200 dark:border-white/10 transition-colors">
            <h4 class="text-lg font-bold text-secondary mb-2">Tracking & Cookies Data</h4>
            <p class="text-gray-600 dark:text-gray-400 mb-4">
                We use cookies and similar tracking technologies to track the activity on our Service and hold certain information. Cookies are files with small amount of data which may include an anonymous unique identifier.
            </p>
            <p class="text-gray-600 dark:text-gray-400">
                You can instruct your browser to refuse all cookies or to indicate when a cookie is being sent. However, if you do not accept cookies, you may not be able to use some portions of our Service.
            </p>
        </div>
    </section>

    <!-- Section 3: Use of Data -->
    <section>
        <div class="flex items-center space-x-3 mb-6">
            <!-- Icon: Server -->
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-secondary"><rect x="2" y="2" width="20" height="8" rx="2" ry="2"></rect><rect x="2" y="14" width="20" height="8" rx="2" ry="2"></rect><line x1="6" y1="6" x2="6.01" y2="6"></line><line x1="6" y1="18" x2="6.01" y2="18"></line></svg>
            <h2 class="text-3xl font-bold text-gray-900 dark:text-white m-0">3. Use of Data</h2>
        </div>
        <p class="text-gray-600 dark:text-gray-400 mb-4">Safe360 uses the collected data for various purposes:</p>
        <ul class="text-gray-600 dark:text-gray-400 space-y-3 pl-4 border-l-2 border-gray-200 dark:border-white/10">
            <li class="pl-2"><strong>To provide and maintain the Service:</strong> Ensuring our platform is accessible and functional.</li>
            <li class="pl-2"><strong>To notify you about changes:</strong> Keeping you updated on new features or maintenance.</li>
            <li class="pl-2"><strong>To allow interactive features:</strong> Enabling VR simulations and real-time assessments.</li>
            <li class="pl-2"><strong>To provide customer care and support:</strong> Troubleshooting issues effectively.</li>
            <li class="pl-2"><strong>To provide analysis:</strong> Gathering valuable information so that we can improve the Service.</li>
            <li class="pl-2"><strong>To monitor usage:</strong> Tracking patterns to optimize performance.</li>
            <li class="pl-2"><strong>To detect, prevent and address technical issues:</strong> Ensuring security and stability.</li>
        </ul>
    </section>

    <!-- Section 4: Legal Basis (GDPR) -->
    <section>
        <div class="flex items-center space-x-3 mb-6">
            <!-- Icon: Scale -->
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-secondary"><path d="m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="M7 21h10"/><path d="M12 3v18"/><path d="M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2"/></svg>
            <h2 class="text-3xl font-bold text-gray-900 dark:text-white m-0">4. Legal Basis for Processing Personal Data Under GDPR</h2>
        </div>
        <p class="text-gray-600 dark:text-gray-400 mb-4">
            If you are from the European Economic Area (EEA), Safe360's legal basis for collecting and using the personal information described in this Privacy Policy depends on the Personal Data we collect and the specific context in which we collect it.
        </p>
        <p class="text-gray-600 dark:text-gray-400 mb-2">Safe360 may process your Personal Data because:</p>
        <ul class="list-disc pl-6 text-gray-600 dark:text-gray-400 space-y-2">
            <li>We need to perform a contract with you.</li>
            <li>You have given us permission to do so.</li>
            <li>The processing is in our legitimate interests and it's not overridden by your rights.</li>
            <li>For payment processing purposes.</li>
            <li>To comply with the law.</li>
        </ul>
    </section>

    <!-- Section 5: Retention -->
    <section>
        <div class="flex items-center space-x-3 mb-6">
            <!-- Icon: RefreshCw -->
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-secondary"><polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>
            <h2 class="text-3xl font-bold text-gray-900 dark:text-white m-0">5. Retention of Data</h2>
        </div>
        <p class="text-gray-600 dark:text-gray-400">
            Safe360 will retain your Personal Data only for as long as is necessary for the purposes set out in this Privacy Policy. We will retain and use your Personal Data to the extent necessary to comply with our legal obligations (for example, if we are required to retain your data to comply with applicable laws), resolve disputes, and enforce our legal agreements and policies.
            <br/><br/>
            Safe360 will also retain Usage Data for internal analysis purposes. Usage Data is generally retained for a shorter period of time, except when this data is used to strengthen the security or to improve the functionality of our Service, or we are legally obligated to retain this data for longer time periods.
        </p>
    </section>

    <!-- Section 6: Transfer -->
    <section>
        <div class="flex items-center space-x-3 mb-6">
            <!-- Icon: Globe -->
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-secondary"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>
            <h2 class="text-3xl font-bold text-gray-900 dark:text-white m-0">6. Transfer of Data</h2>
        </div>
        <p class="text-gray-600 dark:text-gray-400">
            Your information, including Personal Data, may be transferred to — and maintained on — computers located outside of your state, province, country or other governmental jurisdiction where the data protection laws may differ than those from your jurisdiction.
            <br/><br/>
            If you are located outside United Kingdom or Nepal and choose to provide information to us, please note that we transfer the data, including Personal Data, to these locations and process it there.
            <br/><br/>
            Safe360 will take all steps reasonably necessary to ensure that your data is treated securely and in accordance with this Privacy Policy and no transfer of your Personal Data will take place to an organization or a country unless there are adequate controls in place including the security of your data and other personal information.
        </p>
    </section>

    <!-- Section 7: Disclosure -->
    <section>
        <div class="flex items-center space-x-3 mb-6">
            <!-- Icon: Eye -->
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-secondary"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
            <h2 class="text-3xl font-bold text-gray-900 dark:text-white m-0">7. Disclosure of Data</h2>
        </div>
        <div class="space-y-6">
            <div>
                <h4 class="text-xl font-bold text-gray-900 dark:text-white mb-2">Business Transaction</h4>
                <p class="text-gray-600 dark:text-gray-400">If Safe360 is involved in a merger, acquisition or asset sale, your Personal Data may be transferred. We will provide notice before your Personal Data is transferred and becomes subject to a different Privacy Policy.</p>
            </div>
            <div>
                <h4 class="text-xl font-bold text-gray-900 dark:text-white mb-2">Disclosure for Law Enforcement</h4>
                <p class="text-gray-600 dark:text-gray-400">Under certain circumstances, Safe360 may be required to disclose your Personal Data if required to do so by law or in response to valid requests by public authorities (e.g. a court or a government agency).</p>
            </div>
            <div>
                <h4 class="text-xl font-bold text-gray-900 dark:text-white mb-2">Legal Requirements</h4>
                <p class="text-gray-600 dark:text-gray-400">Safe360 may disclose your Personal Data in the good faith belief that such action is necessary to:</p>
                <ul class="list-disc pl-6 text-gray-600 dark:text-gray-400 mt-2">
                    <li>To comply with a legal obligation</li>
                    <li>To protect and defend the rights or property of Safe360</li>
                    <li>To prevent or investigate possible wrongdoing in connection with the Service</li>
                    <li>To protect the personal safety of users of the Service or the public</li>
                    <li>To protect against legal liability</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Section 8: Security -->
    <section>
        <div class="flex items-center space-x-3 mb-6">
            <!-- Icon: Lock -->
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-secondary"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
            <h2 class="text-3xl font-bold text-gray-900 dark:text-white m-0">8. Security of Data</h2>
        </div>
        <p class="text-gray-600 dark:text-gray-400">
            The security of your data is important to us, but remember that no method of transmission over the Internet, or method of electronic storage is 100% secure. While we strive to use commercially acceptable means to protect your Personal Data, we cannot guarantee its absolute security. We utilize industry-standard encryption protocols (SSL/TLS) and secure server infrastructure to safeguard your information.
        </p>
    </section>

    <!-- Section 9: Rights -->
    <section>
        <div class="flex items-center space-x-3 mb-6">
            <!-- Icon: Shield -->
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-secondary"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg>
            <h2 class="text-3xl font-bold text-gray-900 dark:text-white m-0">9. Your Data Protection Rights Under GDPR</h2>
        </div>
        <p class="text-gray-600 dark:text-gray-400 mb-6">
            If you are a resident of the European Economic Area (EEA), you have certain data protection rights. Safe360 aims to take reasonable steps to allow you to correct, amend, delete, or limit the use of your Personal Data.
        </p>
        <div class="grid md:grid-cols-2 gap-6">
            <div class="bg-gray-50 dark:bg-white/5 p-6 rounded-xl border border-gray-200 dark:border-white/10 transition-colors">
                <h4 class="font-bold text-secondary mb-2">Right to Access</h4>
                <p class="text-sm text-gray-600 dark:text-gray-400">You have the right to access, update or to delete the information we have on you.</p>
            </div>
            <div class="bg-gray-50 dark:bg-white/5 p-6 rounded-xl border border-gray-200 dark:border-white/10 transition-colors">
                <h4 class="font-bold text-secondary mb-2">Right of Rectification</h4>
                <p class="text-sm text-gray-600 dark:text-gray-400">You have the right to have your information rectified if that information is inaccurate or incomplete.</p>
            </div>
            <div class="bg-gray-50 dark:bg-white/5 p-6 rounded-xl border border-gray-200 dark:border-white/10 transition-colors">
                <h4 class="font-bold text-secondary mb-2">Right to Object</h4>
                <p class="text-sm text-gray-600 dark:text-gray-400">You have the right to object to our processing of your Personal Data.</p>
            </div>
            <div class="bg-gray-50 dark:bg-white/5 p-6 rounded-xl border border-gray-200 dark:border-white/10 transition-colors">
                <h4 class="font-bold text-secondary mb-2">Right of Restriction</h4>
                <p class="text-sm text-gray-600 dark:text-gray-400">You have the right to request that we restrict the processing of your personal information.</p>
            </div>
        </div>
    </section>

    <!-- Section 10: Service Providers -->
    <section>
        <div class="flex items-center space-x-3 mb-6">
            <!-- Icon: Key -->
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-secondary"><path d="m21 2-2 2m-7.6 7.6a6 6 0 1 1-1.4-1.4L18.4 2.6a1 1 0 0 1 1.4 0l2.6 2.6a1 1 0 0 1 0 1.4l-3.3 3.3a1 1 0 0 1-1.4 0l-1.4-1.4Z"></path></svg>
            <h2 class="text-3xl font-bold text-gray-900 dark:text-white m-0">10. Service Providers</h2>
        </div>
        <p class="text-gray-600 dark:text-gray-400 mb-4">
            We may employ third party companies and individuals to facilitate our Service ("Service Providers"), to provide the Service on our behalf, to perform Service-related services or to assist us in analyzing how our Service is used.
        </p>
        <p class="text-gray-600 dark:text-gray-400">
            These third parties have access to your Personal Data only to perform these tasks on our behalf and are obligated not to disclose or use it for any other purpose.
        </p>
        
        <h4 class="text-xl font-bold text-gray-900 dark:text-white mt-6 mb-2">Analytics</h4>
        <p class="text-gray-600 dark:text-gray-400">
            We may use third-party Service Providers to monitor and analyze the use of our Service.
        </p>
        <ul class="list-disc pl-6 text-gray-600 dark:text-gray-400 mt-2">
            <li><strong>Google Analytics:</strong> Google Analytics is a web analytics service offered by Google that tracks and reports website traffic.</li>
        </ul>
    </section>

    <!-- Contact -->
    <section class="pt-16 border-t border-gray-200 dark:border-white/10">
        <div class="flex items-center space-x-3 mb-6">
            <!-- Icon: Mail -->
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-secondary"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
            <h2 class="text-3xl font-bold text-gray-900 dark:text-white m-0">Contact Us</h2>
        </div>
        <p class="text-gray-600 dark:text-gray-400 mb-6">
            If you have any questions about this Privacy Policy, please contact us:
        </p>
        <div class="grid md:grid-cols-2 gap-8 text-gray-600 dark:text-gray-300">
            <div>
                <p class="font-bold text-gray-900 dark:text-white mb-1">By Email:</p>
                <p class="text-secondary">privacy@safe360.com</p>
            </div>
            <div>
                <p class="font-bold text-gray-900 dark:text-white mb-1">By Mail:</p>
                <p>Safe360 HQ, 123 Tech Avenue,<br/>London, EC1A 1BB, United Kingdom</p>
            </div>
        </div>
    </section>
</div>
`;

const updatePrivacyPage = async () => {
    try {
        await mongoose.connect(process.env.MONGO_URI);
        console.log('MongoDB Connected');

        const pageData = {
            title: 'Privacy <span class="text-secondary">Policy</span>',
            slug: 'privacy',
            content: {
                header: {
                    title: 'Privacy <span class="text-secondary">Policy</span>',
                    description: 'We value your privacy and are committed to protecting your personal data.'
                },
                content: {
                    body: privacyContent
                }
            },
            seo: {
                metaTitle: 'Privacy Policy - Safe360',
                metaDescription: 'Read our Privacy Policy to understand how Safe360 collects, uses, and protects your personal data.'
            }
        };

        const page = await Page.findOneAndUpdate(
            { slug: 'privacy' },
            pageData,
            { new: true, upsert: true }
        );

        console.log('Privacy Page Updated Successfully:', page.slug);
        process.exit(0);
    } catch (err) {
        console.error('Error updating page:', err);
        process.exit(1);
    }
};

updatePrivacyPage();
